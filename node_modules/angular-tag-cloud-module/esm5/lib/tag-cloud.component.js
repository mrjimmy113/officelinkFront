/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, Output, EventEmitter, ElementRef, Renderer2, HostListener } from '@angular/core';
/**
 * @record
 */
function CloudOptionsInternal() { }
if (false) {
    /**
     * setting the aspect ratio. This value is calculated by the given width and height
     * @type {?}
     */
    CloudOptionsInternal.prototype.aspectRatio;
    /** @type {?} */
    CloudOptionsInternal.prototype.center;
}
var TagCloudComponent = /** @class */ (function () {
    function TagCloudComponent(el, r2) {
        this.el = el;
        this.r2 = r2;
        this.clicked = new EventEmitter();
        this.dataChanges = new EventEmitter();
        this.afterInit = new EventEmitter();
        this.afterChecked = new EventEmitter();
        this.alreadyPlacedWords = [];
    }
    /**
     * @param {?} event
     * @return {?}
     */
    TagCloudComponent.prototype.onResize = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        var _this = this;
        this.logMessage('debug', 'rezisze triggered');
        window.clearTimeout(this.timeoutId);
        this.timeoutId = window.setTimeout((/**
         * @return {?}
         */
        function () {
            if (_this.options.realignOnResize) {
                _this.reDraw();
            }
        }), 200);
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    TagCloudComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        this.logMessage('debug', 'ngOnChanges fired', changes);
        // set default values
        this.config = tslib_1.__assign({ width: 500, height: 300, overflow: true, strict: false, zoomOnHover: {
                transitionTime: 0,
                scale: 1,
                delay: 0,
                color: null
            }, realignOnResize: false, randomizeAngle: false, background: null, font: null, step: 2.0, log: false }, this.config // override default width params in config object
        );
        // override properties if explicitly set
        if (this.width) {
            this.config.width = this.width;
        }
        if (this.height) {
            this.config.height = this.height;
        }
        if (typeof this.overflow === 'boolean') {
            this.config.overflow = this.overflow;
        }
        if (typeof this.strict === 'boolean') {
            this.config.strict = this.strict;
        }
        if (typeof this.realignOnResize === 'boolean') {
            this.config.realignOnResize = this.realignOnResize;
        }
        if (typeof this.randomizeAngle === 'boolean') {
            this.config.randomizeAngle = this.randomizeAngle;
        }
        if (typeof this.background === 'string') {
            this.config.background = this.background;
        }
        if (typeof this.font === 'string') {
            this.config.font = this.font;
        }
        if (this.zoomOnHover) {
            this.config.zoomOnHover = this.zoomOnHover;
        }
        if (this.step) {
            this.config.step = this.step;
        }
        if (this.log) {
            this.config.log = this.log;
        }
        this.logMessage('warn', 'cloud configuration', this.config);
        // set the basic font style if property is provided
        if (this.config.font) {
            this.r2.setStyle(this.el.nativeElement, 'font', this.config.font);
        }
        // set a background image if property is provided
        if (this.config.background) {
            this.r2.setStyle(this.el.nativeElement, 'background', this.config.background);
        }
        this.reDraw(changes);
    };
    /**
     * @param {?=} changes
     * @return {?}
     */
    TagCloudComponent.prototype.reDraw = /**
     * @param {?=} changes
     * @return {?}
     */
    function (changes) {
        this.dataChanges.emit(changes);
        this.afterChecked.emit();
        this.logMessage('debug', 'dataChanges emitted');
        this.alreadyPlacedWords = [];
        // check if data is not null or empty
        if (!this.data) {
            console.error('angular-tag-cloud: No data passed. Please pass an Array of CloudData');
            return;
        }
        // values changed, reset cloud
        this.el.nativeElement.innerHTML = '';
        // set value changes
        if (changes && changes.data) {
            this.dataArr = changes.data.currentValue;
        }
        // calculate width and height
        /** @type {?} */
        var width = this.config.width;
        if (this.el.nativeElement.parentNode.offsetWidth > 0
            && width <= 1
            && width > 0) {
            width = this.el.nativeElement.parentNode.offsetWidth * width;
        }
        /** @type {?} */
        var height = this.config.height;
        // set options
        this.options = tslib_1.__assign({}, this.config, { aspectRatio: (width / height), width: width, center: {
                x: (width / 2.0),
                y: (height / 2.0)
            } });
        // set the dimensions
        this.r2.setStyle(this.el.nativeElement, 'width', this.options.width + 'px');
        this.r2.setStyle(this.el.nativeElement, 'height', this.options.height + 'px');
        // draw the cloud
        this.drawWordCloud();
        this.logMessage('debug', 'reDraw finished');
    };
    /**
     * @return {?}
     */
    TagCloudComponent.prototype.ngAfterContentInit = /**
     * @return {?}
     */
    function () {
        this.afterInit.emit();
        this.logMessage('debug', 'afterInit emitted');
    };
    /**
     * @return {?}
     */
    TagCloudComponent.prototype.ngAfterContentChecked = /**
     * @return {?}
     */
    function () {
        this.afterChecked.emit();
        this.logMessage('debug', 'afterChecked emitted');
    };
    // helper to generate a descriptive string for an entry to use when sorting alphabetically
    // helper to generate a descriptive string for an entry to use when sorting alphabetically
    /**
     * @private
     * @param {?} entry
     * @return {?}
     */
    TagCloudComponent.prototype.descriptiveEntry = 
    // helper to generate a descriptive string for an entry to use when sorting alphabetically
    /**
     * @private
     * @param {?} entry
     * @return {?}
     */
    function (entry) {
        /** @type {?} */
        var description = entry.text;
        if (entry.color) {
            description += '-' + entry.color;
        }
        if (entry.external) {
            description += '-' + entry.external;
        }
        if (entry.link) {
            description += '-' + entry.link;
        }
        if (entry.rotate) {
            description += '-' + entry.rotate;
        }
        return description;
    };
    /**
     * @private
     * @return {?}
     */
    TagCloudComponent.prototype.drawWordCloud = /**
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        // Sort alphabetically to ensure that, all things being equal, words are placed uniformly
        this.dataArr.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function (a, b) { return (_this.descriptiveEntry(a)).localeCompare(_this.descriptiveEntry(b)); }));
        // Sort this._dataArr from the word with the highest weight to the one with the lowest
        this.dataArr.sort((/**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function (a, b) { return b.weight - a.weight; }));
        this.dataArr.forEach((/**
         * @param {?} elem
         * @param {?} index
         * @return {?}
         */
        function (elem, index) {
            _this.drawWord(index, elem);
        }));
    };
    // Helper function to test if an element overlaps others
    // Helper function to test if an element overlaps others
    /**
     * @private
     * @param {?} testEl
     * @return {?}
     */
    TagCloudComponent.prototype.hitTest = 
    // Helper function to test if an element overlaps others
    /**
     * @private
     * @param {?} testEl
     * @return {?}
     */
    function (testEl) {
        var e_1, _a;
        try {
            // Check elements for overlap one by one, stop and return false as soon as an overlap is found
            for (var _b = tslib_1.__values(this.alreadyPlacedWords), _c = _b.next(); !_c.done; _c = _b.next()) {
                var item = _c.value;
                if (this.overlapping(testEl, item)) {
                    return true;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return false;
    };
    // Pairwise overlap detection
    // Pairwise overlap detection
    /**
     * @private
     * @param {?} e1
     * @param {?} e2
     * @return {?}
     */
    TagCloudComponent.prototype.overlapping = 
    // Pairwise overlap detection
    /**
     * @private
     * @param {?} e1
     * @param {?} e2
     * @return {?}
     */
    function (e1, e2) {
        /** @type {?} */
        var rect1 = e1.getBoundingClientRect();
        /** @type {?} */
        var rect2 = e2.getBoundingClientRect();
        /** @type {?} */
        var overlap = !(rect1.right < rect2.left ||
            rect1.left > rect2.right ||
            rect1.bottom < rect2.top ||
            rect1.top > rect2.bottom);
        return overlap;
    };
    // Function to draw a word, by moving it in spiral until it finds a suitable empty place. This will be iterated on each word.
    // Function to draw a word, by moving it in spiral until it finds a suitable empty place. This will be iterated on each word.
    /**
     * @private
     * @param {?} index
     * @param {?} word
     * @return {?}
     */
    TagCloudComponent.prototype.drawWord = 
    // Function to draw a word, by moving it in spiral until it finds a suitable empty place. This will be iterated on each word.
    /**
     * @private
     * @param {?} index
     * @param {?} word
     * @return {?}
     */
    function (index, word) {
        var _this = this;
        // Define the ID attribute of the span that will wrap the word
        /** @type {?} */
        var angle = this.options.randomizeAngle ? 6.28 * Math.random() : 0;
        /** @type {?} */
        var radius = 0;
        /** @type {?} */
        var weight = 5;
        /** @type {?} */
        var wordSpan;
        // Check if min(weight) > max(weight) otherwise use default
        if (this.dataArr[0].weight > this.dataArr[this.dataArr.length - 1].weight) {
            // check if strict mode is active
            if (!this.options.strict) { // Linearly map the original weight to a discrete scale from 1 to 10
                weight = Math.round((word.weight - this.dataArr[this.dataArr.length - 1].weight) /
                    (this.dataArr[0].weight - this.dataArr[this.dataArr.length - 1].weight) * 9.0) + 1;
            }
            else { // use given value for weigth directly
                // fallback to 10
                if (word.weight > 10) {
                    weight = 10;
                    this.logMessage('warn', "[TagCloud strict] Weight property " + word.weight + " > 10. Fallback to 10 as you are using strict mode", word);
                }
                else if (word.weight < 1) { // fallback to 1
                    weight = 1;
                    this.logMessage('warn', "[TagCloud strict] Given weight property " + word.weight + " < 1. Fallback to 1 as you are using strict mode", word);
                }
                else if (word.weight % 1 !== 0) { // round if given value is not an integer
                    weight = Math.round(word.weight);
                    this.logMessage('warn', "[TagCloud strict] Given weight property " + word.weight + " is not an integer. Rounded value to " + weight, word);
                }
                else {
                    weight = word.weight;
                }
            }
        }
        // Create a new span and insert node.
        wordSpan = this.r2.createElement('span');
        wordSpan.className = 'w' + weight;
        /** @type {?} */
        var thatClicked = this.clicked;
        wordSpan.onclick = (/**
         * @return {?}
         */
        function () {
            thatClicked.emit(word);
        });
        /** @type {?} */
        var node = this.r2.createText(word.text);
        // set color
        if (word.color) {
            this.r2.setStyle(wordSpan, 'color', word.color);
        }
        /** @type {?} */
        var transformString = '';
        // set color
        if (word.rotate) {
            transformString = "rotate(" + word.rotate + "deg)";
            this.r2.setStyle(wordSpan, 'transform', transformString);
        }
        // Append href if there's a link alongwith the tag
        if (word.link) {
            /** @type {?} */
            var wordLink = this.r2.createElement('a');
            wordLink.href = word.link;
            if (word.external !== undefined && word.external) {
                wordLink.target = '_blank';
            }
            wordLink.appendChild(node);
            node = wordLink;
        }
        // set zoomOption
        if (this.options.zoomOnHover && this.options.zoomOnHover.scale !== 1) {
            if (!this.options.zoomOnHover.transitionTime) {
                this.options.zoomOnHover.transitionTime = 0;
            }
            if (!this.options.zoomOnHover.scale) {
                this.options.zoomOnHover.scale = 1;
            }
            wordSpan.onmouseover = (/**
             * @return {?}
             */
            function () {
                _this.r2.setStyle(wordSpan, 'transition', "transform " + _this.options.zoomOnHover.transitionTime + "s");
                _this.r2.setStyle(wordSpan, 'transform', "scale(" + _this.options.zoomOnHover.scale + ") " + transformString);
                _this.r2.setStyle(wordSpan, 'transition-delay', _this.options.zoomOnHover.delay + "s");
                if (_this.options.zoomOnHover.color) {
                    word.link
                        ? _this.r2.setStyle(node, 'color', _this.options.zoomOnHover.color)
                        : _this.r2.setStyle(wordSpan, 'color', _this.options.zoomOnHover.color);
                }
            });
            wordSpan.onmouseout = (/**
             * @return {?}
             */
            function () {
                _this.r2.setStyle(wordSpan, 'transform', "none " + transformString);
                word.link
                    ? _this.r2.removeStyle(node, 'color')
                    : _this.r2.removeStyle(wordSpan, 'color');
            });
        }
        wordSpan.appendChild(node);
        this.r2.appendChild(this.el.nativeElement, wordSpan);
        /** @type {?} */
        var width = wordSpan.offsetWidth;
        /** @type {?} */
        var height = wordSpan.offsetHeight;
        /** @type {?} */
        var left = this.options.center.x - (width / 2);
        /** @type {?} */
        var top = this.options.center.y - (height / 2);
        // Save a reference to the style property, for better performance
        /** @type {?} */
        var wordStyle = wordSpan.style;
        wordStyle.position = 'absolute';
        // place the first word
        wordStyle.left = left + 'px';
        wordStyle.top = top + 'px';
        // add tooltip if provided
        if (word.tooltip) {
            this.r2.addClass(wordSpan, 'tooltip');
            /** @type {?} */
            var tooltipSpan = this.r2.createElement('span');
            tooltipSpan.className = 'tooltiptext';
            /** @type {?} */
            var text = this.r2.createText(word.tooltip);
            tooltipSpan.appendChild(text);
            wordSpan.appendChild(tooltipSpan);
        }
        // set a unique id
        wordSpan.id = "angular-tag-cloud-item-" + index;
        while (this.hitTest(wordSpan)) {
            radius += this.options.step;
            angle += (index % 2 === 0 ? 1 : -1) * this.options.step;
            left = this.options.center.x - (width / 2.0) + (radius * Math.cos(angle)) * this.options.aspectRatio;
            top = this.options.center.y + radius * Math.sin(angle) - (height / 2.0);
            wordStyle.left = left + 'px';
            wordStyle.top = top + 'px';
        }
        // do not place the first word always right in the middle
        if (index === 0) {
            wordStyle.left = left + ((Math.random() - 0.5) * 2) * (this.options.width / 5) + 'px';
            wordStyle.top = top + ((Math.random() - 0.5) * 2) * (this.options.height / 5) + '30px';
        }
        // Don't render word if part of it would be outside the container
        if (!this.options.overflow &&
            (left < 0 || top < 0 || (left + width) > this.options.width ||
                (top + height) > this.options.height)) {
            this.logMessage('warn', 'Word did not fit into the cloud and overflow is set to \'false\'. The element will be removed', wordSpan);
            wordSpan.remove();
            return;
        }
        this.logMessage('debug', 'Adds new word <span>', wordSpan);
        this.alreadyPlacedWords.push(wordSpan);
        this.logMessage('debug', 'Placed words', this.alreadyPlacedWords);
    };
    /**
     * @private
     * @param {?} level
     * @param {...?} args
     * @return {?}
     */
    TagCloudComponent.prototype.logMessage = /**
     * @private
     * @param {?} level
     * @param {...?} args
     * @return {?}
     */
    function (level) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        if (!this.config) {
            return;
        }
        if (this.config.log === 'debug') {
            console.log.apply(console, tslib_1.__spread(["[AngularTagCloudModule " + level + "]"], args));
        }
        else if (this.config.log === 'warn' && level === 'warn') {
            console.warn.apply(console, tslib_1.__spread(["[AngularTagCloudModule " + level + "]"], args));
        }
    };
    TagCloudComponent.decorators = [
        { type: Component, args: [{
                    selector: 'angular-tag-cloud, ng-tag-cloud, ngtc',
                    template: '',
                    styles: [":host{font-family:Helvetica,Arial,sans-serif;font-size:10px;line-height:normal;color:#09f;overflow:hidden;position:relative;display:block}span{padding:0}span.w10{font-size:550%}span.w9{font-size:500%}span.w8{font-size:450%}span.w7{font-size:400%}span.w6{font-size:350%}span.w5{font-size:300%}span.w4{font-size:250%}span.w3{font-size:200%}span.w2{font-size:150%}a:hover,span.w10,span.w8,span.w9{color:#0cf}span.w7{color:#39d}span.w6{color:#90c5f0}span.w5{color:#90a0dd}span.w4{color:#90c5f0}span.w3{color:#a0ddff}span.w2{color:#9ce}span.w1{font-size:100%;color:#aab5f0}.tooltip .tooltiptext{visibility:hidden;width:inherit;background-color:#555;color:#fff;text-align:center;border-radius:6px;padding:5px 10px;position:absolute;bottom:100%;left:0;opacity:0;transition:opacity .3s}.tooltip .tooltiptext::after{content:\"\";position:absolute;top:100%;left:50%;margin-left:-5px;border-width:5px;border-style:solid;border-color:#555 transparent transparent}.tooltip:hover .tooltiptext{visibility:visible;opacity:1}"]
                }] }
    ];
    /** @nocollapse */
    TagCloudComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: Renderer2 }
    ]; };
    TagCloudComponent.propDecorators = {
        data: [{ type: Input }],
        width: [{ type: Input }],
        height: [{ type: Input }],
        step: [{ type: Input }],
        overflow: [{ type: Input }],
        strict: [{ type: Input }],
        zoomOnHover: [{ type: Input }],
        realignOnResize: [{ type: Input }],
        randomizeAngle: [{ type: Input }],
        background: [{ type: Input }],
        font: [{ type: Input }],
        config: [{ type: Input }],
        log: [{ type: Input }],
        clicked: [{ type: Output }],
        dataChanges: [{ type: Output }],
        afterInit: [{ type: Output }],
        afterChecked: [{ type: Output }],
        onResize: [{ type: HostListener, args: ['window:resize', ['$event'],] }]
    };
    return TagCloudComponent;
}());
export { TagCloudComponent };
if (false) {
    /** @type {?} */
    TagCloudComponent.prototype.data;
    /** @type {?} */
    TagCloudComponent.prototype.width;
    /** @type {?} */
    TagCloudComponent.prototype.height;
    /** @type {?} */
    TagCloudComponent.prototype.step;
    /** @type {?} */
    TagCloudComponent.prototype.overflow;
    /** @type {?} */
    TagCloudComponent.prototype.strict;
    /** @type {?} */
    TagCloudComponent.prototype.zoomOnHover;
    /** @type {?} */
    TagCloudComponent.prototype.realignOnResize;
    /** @type {?} */
    TagCloudComponent.prototype.randomizeAngle;
    /** @type {?} */
    TagCloudComponent.prototype.background;
    /** @type {?} */
    TagCloudComponent.prototype.font;
    /** @type {?} */
    TagCloudComponent.prototype.config;
    /** @type {?} */
    TagCloudComponent.prototype.log;
    /** @type {?} */
    TagCloudComponent.prototype.clicked;
    /** @type {?} */
    TagCloudComponent.prototype.dataChanges;
    /** @type {?} */
    TagCloudComponent.prototype.afterInit;
    /** @type {?} */
    TagCloudComponent.prototype.afterChecked;
    /**
     * @type {?}
     * @private
     */
    TagCloudComponent.prototype.dataArr;
    /**
     * @type {?}
     * @private
     */
    TagCloudComponent.prototype.alreadyPlacedWords;
    /**
     * @type {?}
     * @private
     */
    TagCloudComponent.prototype.options;
    /**
     * @type {?}
     * @private
     */
    TagCloudComponent.prototype.timeoutId;
    /**
     * @type {?}
     * @private
     */
    TagCloudComponent.prototype.el;
    /**
     * @type {?}
     * @private
     */
    TagCloudComponent.prototype.r2;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFnLWNsb3VkLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2FuZ3VsYXItdGFnLWNsb3VkLW1vZHVsZS8iLCJzb3VyY2VzIjpbImxpYi90YWctY2xvdWQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFJVCxLQUFLLEVBQ0wsTUFBTSxFQUNOLFlBQVksRUFDWixVQUFVLEVBQ1YsU0FBUyxFQUVULFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQzs7OztBQUc3QyxtQ0FTQzs7Ozs7O0lBTEMsMkNBQW9COztJQUNwQixzQ0FHRTs7QUFHSjtJQStCRSwyQkFDVSxFQUFjLEVBQ2QsRUFBYTtRQURiLE9BQUUsR0FBRixFQUFFLENBQVk7UUFDZCxPQUFFLEdBQUYsRUFBRSxDQUFXO1FBYmIsWUFBTyxHQUE2QixJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ3ZELGdCQUFXLEdBQWlDLElBQUksWUFBWSxFQUFFLENBQUM7UUFDL0QsY0FBUyxHQUF3QixJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ3BELGlCQUFZLEdBQXdCLElBQUksWUFBWSxFQUFFLENBQUM7UUFHekQsdUJBQWtCLEdBQWtCLEVBQUUsQ0FBQztJQVEzQyxDQUFDOzs7OztJQUVzQyxvQ0FBUTs7OztJQUFuRCxVQUFvRCxLQUFVO1FBQTlELGlCQVdDO1FBVkMsSUFBSSxDQUFDLFVBQVUsQ0FDYixPQUFPLEVBQ1AsbUJBQW1CLENBQ3BCLENBQUM7UUFDRixNQUFNLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNwQyxJQUFJLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQyxVQUFVOzs7UUFBQztZQUNqQyxJQUFJLEtBQUksQ0FBQyxPQUFPLENBQUMsZUFBZSxFQUFFO2dCQUNoQyxLQUFJLENBQUMsTUFBTSxFQUFFLENBQUM7YUFDZjtRQUNILENBQUMsR0FBRSxHQUFHLENBQUMsQ0FBQztJQUNWLENBQUM7Ozs7O0lB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ICAgICAgIEFmdGVyQ29udGVudEluaXQsXG4gICAgICAgICBBZnRlckNvbnRlbnRDaGVja2VkLFxuICAgICAgICAgSW5wdXQsXG4gICAgICAgICBPdXRwdXQsXG4gICAgICAgICBFdmVudEVtaXR0ZXIsXG4gICAgICAgICBFbGVtZW50UmVmLFxuICAgICAgICAgUmVuZGVyZXIyLFxuICAgICAgICAgU2ltcGxlQ2hhbmdlcyxcbiAgICAgICAgIEhvc3RMaXN0ZW5lciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ2xvdWREYXRhLCBDbG91ZE9wdGlvbnMsIFpvb21PbkhvdmVyT3B0aW9ucyB9IGZyb20gJy4vdGFnLWNsb3VkLmludGVyZmFjZXMnO1xuXG5pbnRlcmZhY2UgQ2xvdWRPcHRpb25zSW50ZXJuYWwgZXh0ZW5kcyBDbG91ZE9wdGlvbnMge1xuICAvKipcbiAgICogc2V0dGluZyB0aGUgYXNwZWN0IHJhdGlvLiBUaGlzIHZhbHVlIGlzIGNhbGN1bGF0ZWQgYnkgdGhlIGdpdmVuIHdpZHRoIGFuZCBoZWlnaHRcbiAgICovXG4gIGFzcGVjdFJhdGlvOiBudW1iZXI7XG4gIGNlbnRlcjoge1xuICAgIHg6IG51bWJlcjtcbiAgICB5OiBudW1iZXI7XG4gIH07XG59XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2FuZ3VsYXItdGFnLWNsb3VkLCBuZy10YWctY2xvdWQsIG5ndGMnLFxuICB0ZW1wbGF0ZTogJycsXG4gIHN0eWxlVXJsczogWycuL3RhZy1jbG91ZC5jb21wb25lbnQuY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgVGFnQ2xvdWRDb21wb25lbnQgaW1wbGVtZW50cyBPbkNoYW5nZXMsIEFmdGVyQ29udGVudEluaXQsIEFmdGVyQ29udGVudENoZWNrZWQge1xuICBASW5wdXQoKSBkYXRhOiBDbG91ZERhdGFbXTtcbiAgQElucHV0KCkgd2lkdGg6IG51bWJlcjtcbiAgQElucHV0KCkgaGVpZ2h0OiBudW1iZXI7XG4gIEBJbnB1dCgpIHN0ZXA6IG51bWJlcjtcbiAgQElucHV0KCkgb3ZlcmZsb3c6IGJvb2xlYW47XG4gIEBJbnB1dCgpIHN0cmljdDogYm9vbGVhbjtcbiAgQElucHV0KCkgem9vbU9uSG92ZXI6IFpvb21PbkhvdmVyT3B0aW9ucztcbiAgQElucHV0KCkgcmVhbGlnbk9uUmVzaXplOiBib29sZWFuO1xuICBASW5wdXQoKSByYW5kb21pemVBbmdsZTogYm9vbGVhbjtcbiAgQElucHV0KCkgYmFja2dyb3VuZDogc3RyaW5nO1xuICBASW5wdXQoKSBmb250OiBzdHJpbmc7XG4gIEBJbnB1dCgpIGNvbmZpZzogQ2xvdWRPcHRpb25zO1xuICBASW5wdXQoKSBsb2c6ICd3YXJuJyB8ICdkZWJ1ZycgfCBmYWxzZTtcblxuICBAT3V0cHV0KCkgY2xpY2tlZD86IEV2ZW50RW1pdHRlcjxDbG91ZERhdGE+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICBAT3V0cHV0KCkgZGF0YUNoYW5nZXM/OiBFdmVudEVtaXR0ZXI8U2ltcGxlQ2hhbmdlcz4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBPdXRwdXQoKSBhZnRlckluaXQ/OiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBPdXRwdXQoKSBhZnRlckNoZWNrZWQ/OiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgcHJpdmF0ZSBkYXRhQXJyOiBDbG91ZERhdGFbXTtcbiAgcHJpdmF0ZSBhbHJlYWR5UGxhY2VkV29yZHM6IEhUTUxFbGVtZW50W10gPSBbXTtcblxuICBwcml2YXRlIG9wdGlvbnM6IENsb3VkT3B0aW9uc0ludGVybmFsO1xuICBwcml2YXRlIHRpbWVvdXRJZDtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGVsOiBFbGVtZW50UmVmLFxuICAgIHByaXZhdGUgcjI6IFJlbmRlcmVyMlxuICApIHsgfVxuXG4gIEBIb3N0TGlzdGVuZXIoJ3dpbmRvdzpyZXNpemUnLCBbJyRldmVudCddKSBvblJlc2l6ZShldmVudDogYW55KSB7XG4gICAgdGhpcy5sb2dNZXNzYWdlKFxuICAgICAgJ2RlYnVnJyxcbiAgICAgICdyZXppc3plIHRyaWdnZXJlZCdcbiAgICApO1xuICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy50aW1lb3V0SWQpO1xuICAgIHRoaXMudGltZW91dElkID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgaWYgKHRoaXMub3B0aW9ucy5yZWFsaWduT25SZXNpemUpIHtcbiAgICAgICAgdGhpcy5yZURyYXcoKTtcbiAgICAgIH1cbiAgICB9LCAyMDApO1xuICB9XG5cbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgIHRoaXMubG9nTWVzc2FnZShcbiAgICAgICdkZWJ1ZycsXG4gICAgICAnbmdPbkNoYW5nZXMgZmlyZWQnLFxuICAgICAgY2hhbmdlc1xuICAgICk7XG4gICAgLy8gc2V0IGRlZmF1bHQgdmFsdWVzXG4gICAgdGhpcy5jb25maWcgPSB7XG4gICAgICB3aWR0aDogNTAwLFxuICAgICAgaGVpZ2h0OiAzMDAsXG4gICAgICBvdmVyZmxvdzogdHJ1ZSxcbiAgICAgIHN0cmljdDogZmFsc2UsXG4gICAgICB6b29tT25Ib3Zlcjoge1xuICAgICAgICB0cmFuc2l0aW9uVGltZTogMCxcbiAgICAgICAgc2NhbGU6IDEsXG4gICAgICAgIGRlbGF5OiAwLFxuICAgICAgICBjb2xvcjogbnVsbFxuICAgICAgfSxcbiAgICAgIHJlYWxpZ25PblJlc2l6ZTogZmFsc2UsXG4gICAgICByYW5kb21pemVBbmdsZTogZmFsc2UsXG4gICAgICBiYWNrZ3JvdW5kOiBudWxsLFxuICAgICAgZm9udDogbnVsbCxcbiAgICAgIHN0ZXA6IDIuMCxcbiAgICAgIGxvZzogZmFsc2UsXG4gICAgICAuLi50aGlzLmNvbmZpZyAvLyBvdmVycmlkZSBkZWZhdWx0IHdpZHRoIHBhcmFtcyBpbiBjb25maWcgb2JqZWN0XG4gICAgfTtcblxuICAgIC8vIG92ZXJyaWRlIHByb3BlcnRpZXMgaWYgZXhwbGljaXRseSBzZXRcbiAgICBpZiAodGhpcy53aWR0aCkgeyB0aGlzLmNvbmZpZy53aWR0aCA9IHRoaXMud2lkdGg7IH1cbiAgICBpZiAodGhpcy5oZWlnaHQpIHsgdGhpcy5jb25maWcuaGVpZ2h0ID0gdGhpcy5oZWlnaHQ7IH1cbiAgICBpZiAodHlwZW9mIHRoaXMub3ZlcmZsb3cgPT09ICdib29sZWFuJykgeyB0aGlzLmNvbmZpZy5vdmVyZmxvdyA9IHRoaXMub3ZlcmZsb3c7IH1cbiAgICBpZiAodHlwZW9mIHRoaXMuc3RyaWN0ID09PSAnYm9vbGVhbicpIHsgdGhpcy5jb25maWcuc3RyaWN0ID0gdGhpcy5zdHJpY3Q7IH1cbiAgICBpZiAodHlwZW9mIHRoaXMucmVhbGlnbk9uUmVzaXplID09PSAnYm9vbGVhbicpIHsgdGhpcy5jb25maWcucmVhbGlnbk9uUmVzaXplID0gdGhpcy5yZWFsaWduT25SZXNpemU7IH1cbiAgICBpZiAodHlwZW9mIHRoaXMucmFuZG9taXplQW5nbGUgPT09ICdib29sZWFuJykgeyB0aGlzLmNvbmZpZy5yYW5kb21pemVBbmdsZSA9IHRoaXMucmFuZG9taXplQW5nbGU7IH1cbiAgICBpZiAodHlwZW9mIHRoaXMuYmFja2dyb3VuZCA9PT0gJ3N0cmluZycpIHsgdGhpcy5jb25maWcuYmFja2dyb3VuZCA9IHRoaXMuYmFja2dyb3VuZDsgfVxuICAgIGlmICh0eXBlb2YgdGhpcy5mb250ID09PSAnc3RyaW5nJykgeyB0aGlzLmNvbmZpZy5mb250ID0gdGhpcy5mb250OyB9XG4gICAgaWYgKHRoaXMuem9vbU9uSG92ZXIpIHsgdGhpcy5jb25maWcuem9vbU9uSG92ZXIgPSB0aGlzLnpvb21PbkhvdmVyOyB9XG4gICAgaWYgKHRoaXMuc3RlcCkgeyB0aGlzLmNvbmZpZy5zdGVwID0gdGhpcy5zdGVwOyB9XG4gICAgaWYgKHRoaXMubG9nKSB7IHRoaXMuY29uZmlnLmxvZyA9IHRoaXMubG9nOyB9XG5cbiAgICB0aGlzLmxvZ01lc3NhZ2UoJ3dhcm4nLCAnY2xvdWQgY29uZmlndXJhdGlvbicsIHRoaXMuY29uZmlnKTtcblxuICAgIC8vIHNldCB0aGUgYmFzaWMgZm9udCBzdHlsZSBpZiBwcm9wZXJ0eSBpcyBwcm92aWRlZFxuICAgIGlmICh0aGlzLmNvbmZpZy5mb250KSB7XG4gICAgICB0aGlzLnIyLnNldFN0eWxlKHRoaXMuZWwubmF0aXZlRWxlbWVudCwgJ2ZvbnQnLCB0aGlzLmNvbmZpZy5mb250KTtcbiAgICB9XG5cbiAgICAvLyBzZXQgYSBiYWNrZ3JvdW5kIGltYWdlIGlmIHByb3BlcnR5IGlzIHByb3ZpZGVkXG4gICAgaWYgKHRoaXMuY29uZmlnLmJhY2tncm91bmQpIHtcbiAgICAgIHRoaXMucjIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnYmFja2dyb3VuZCcsIHRoaXMuY29uZmlnLmJhY2tncm91bmQpO1xuICAgIH1cblxuXG4gICAgdGhpcy5yZURyYXcoY2hhbmdlcyk7XG4gIH1cblxuICByZURyYXcoY2hhbmdlcz86IFNpbXBsZUNoYW5nZXMpIHtcbiAgICB0aGlzLmRhdGFDaGFuZ2VzLmVtaXQoY2hhbmdlcyk7XG4gICAgdGhpcy5hZnRlckNoZWNrZWQuZW1pdCgpO1xuICAgIHRoaXMubG9nTWVzc2FnZShcbiAgICAgICdkZWJ1ZycsXG4gICAgICAnZGF0YUNoYW5nZXMgZW1pdHRlZCdcbiAgICApO1xuICAgIHRoaXMuYWxyZWFkeVBsYWNlZFdvcmRzID0gW107XG5cbiAgICAvLyBjaGVjayBpZiBkYXRhIGlzIG5vdCBudWxsIG9yIGVtcHR5XG4gICAgaWYgKCF0aGlzLmRhdGEpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ2FuZ3VsYXItdGFnLWNsb3VkOiBObyBkYXRhIHBhc3NlZC4gUGxlYXNlIHBhc3MgYW4gQXJyYXkgb2YgQ2xvdWREYXRhJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gdmFsdWVzIGNoYW5nZWQsIHJlc2V0IGNsb3VkXG4gICAgdGhpcy5lbC5uYXRpdmVFbGVtZW50LmlubmVySFRNTCA9ICcnO1xuXG4gICAgLy8gc2V0IHZhbHVlIGNoYW5nZXNcbiAgICBpZiAoY2hhbmdlcyAmJiBjaGFuZ2VzLmRhdGEpIHtcbiAgICAgIHRoaXMuZGF0YUFyciA9IGNoYW5nZXMuZGF0YS5jdXJyZW50VmFsdWU7XG4gICAgfVxuXG4gICAgLy8gY2FsY3VsYXRlIHdpZHRoIGFuZCBoZWlnaHRcbiAgICBsZXQgd2lkdGggPSB0aGlzLmNvbmZpZy53aWR0aDtcbiAgICBpZiAodGhpcy5lbC5uYXRpdmVFbGVtZW50LnBhcmVudE5vZGUub2Zmc2V0V2lkdGggPiAwXG4gICAgICAmJiB3aWR0aCA8PSAxXG4gICAgICAmJiB3aWR0aCA+IDBcbiAgICApIHtcbiAgICAgIHdpZHRoID0gdGhpcy5lbC5uYXRpdmVFbGVtZW50LnBhcmVudE5vZGUub2Zmc2V0V2lkdGggKiB3aWR0aDtcbiAgICB9XG4gICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5jb25maWcuaGVpZ2h0O1xuXG4gICAgLy8gc2V0IG9wdGlvbnNcbiAgICB0aGlzLm9wdGlvbnMgPSB7XG4gICAgICAuLi50aGlzLmNvbmZpZyxcbiAgICAgIGFzcGVjdFJhdGlvOiAod2lkdGggLyBoZWlnaHQpLFxuICAgICAgd2lkdGgsXG4gICAgICBjZW50ZXI6IHtcbiAgICAgICAgeDogKHdpZHRoIC8gMi4wKSxcbiAgICAgICAgeTogKGhlaWdodCAvIDIuMClcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gc2V0IHRoZSBkaW1lbnNpb25zXG4gICAgdGhpcy5yMi5zZXRTdHlsZSh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsICd3aWR0aCcsIHRoaXMub3B0aW9ucy53aWR0aCArICdweCcpO1xuICAgIHRoaXMucjIuc2V0U3R5bGUodGhpcy5lbC5uYXRpdmVFbGVtZW50LCAnaGVpZ2h0JywgdGhpcy5vcHRpb25zLmhlaWdodCArICdweCcpO1xuXG4gICAgLy8gZHJhdyB0aGUgY2xvdWRcbiAgICB0aGlzLmRyYXdXb3JkQ2xvdWQoKTtcbiAgICB0aGlzLmxvZ01lc3NhZ2UoXG4gICAgICAnZGVidWcnLFxuICAgICAgJ3JlRHJhdyBmaW5pc2hlZCdcbiAgICApO1xuICB9XG5cblxuICBuZ0FmdGVyQ29udGVudEluaXQoKSB7XG4gICAgdGhpcy5hZnRlckluaXQuZW1pdCgpO1xuICAgIHRoaXMubG9nTWVzc2FnZShcbiAgICAgICdkZWJ1ZycsXG4gICAgICAnYWZ0ZXJJbml0IGVtaXR0ZWQnXG4gICAgKTtcbiAgfVxuXG4gIG5nQWZ0ZXJDb250ZW50Q2hlY2tlZCgpIHtcbiAgICB0aGlzLmFmdGVyQ2hlY2tlZC5lbWl0KCk7XG4gICAgdGhpcy5sb2dNZXNzYWdlKFxuICAgICAgJ2RlYnVnJyxcbiAgICAgICdhZnRlckNoZWNrZWQgZW1pdHRlZCdcbiAgICApO1xuICB9XG5cbiAgLy8gaGVscGVyIHRvIGdlbmVyYXRlIGEgZGVzY3JpcHRpdmUgc3RyaW5nIGZvciBhbiBlbnRyeSB0byB1c2Ugd2hlbiBzb3J0aW5nIGFscGhhYmV0aWNhbGx5XG4gIHByaXZhdGUgZGVzY3JpcHRpdmVFbnRyeShlbnRyeTogQ2xvdWREYXRhKTogc3RyaW5nIHtcbiAgICBsZXQgZGVzY3JpcHRpb24gPSBlbnRyeS50ZXh0O1xuICAgIGlmIChlbnRyeS5jb2xvcikge1xuICAgICAgZGVzY3JpcHRpb24gKz0gJy0nICsgZW50cnkuY29sb3I7XG4gICAgfVxuICAgIGlmIChlbnRyeS5leHRlcm5hbCkge1xuICAgICAgZGVzY3JpcHRpb24gKz0gJy0nICsgZW50cnkuZXh0ZXJuYWw7XG4gICAgfVxuICAgIGlmIChlbnRyeS5saW5rKSB7XG4gICAgICBkZXNjcmlwdGlvbiArPSAnLScgKyBlbnRyeS5saW5rO1xuICAgIH1cbiAgICBpZiAoZW50cnkucm90YXRlKSB7XG4gICAgICBkZXNjcmlwdGlvbiArPSAnLScgKyBlbnRyeS5yb3RhdGU7XG4gICAgfVxuICAgIHJldHVybiBkZXNjcmlwdGlvbjtcbiAgfVxuXG4gIHByaXZhdGUgZHJhd1dvcmRDbG91ZCgpIHtcbiAgICAvLyBTb3J0IGFscGhhYmV0aWNhbGx5IHRvIGVuc3VyZSB0aGF0LCBhbGwgdGhpbmdzIGJlaW5nIGVxdWFsLCB3b3JkcyBhcmUgcGxhY2VkIHVuaWZvcm1seVxuICAgIHRoaXMuZGF0YUFyci5zb3J0KChhLCBiKSA9PiAodGhpcy5kZXNjcmlwdGl2ZUVudHJ5KGEpKS5sb2NhbGVDb21wYXJlKHRoaXMuZGVzY3JpcHRpdmVFbnRyeShiKSkpO1xuICAgIC8vIFNvcnQgdGhpcy5fZGF0YUFyciBmcm9tIHRoZSB3b3JkIHdpdGggdGhlIGhpZ2hlc3Qgd2VpZ2h0IHRvIHRoZSBvbmUgd2l0aCB0aGUgbG93ZXN0XG4gICAgdGhpcy5kYXRhQXJyLnNvcnQoKGEsIGIpID0+IGIud2VpZ2h0IC0gYS53ZWlnaHQpO1xuICAgIHRoaXMuZGF0YUFyci5mb3JFYWNoKChlbGVtLCBpbmRleCkgPT4ge1xuICAgICAgdGhpcy5kcmF3V29yZChpbmRleCwgZWxlbSk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gdGVzdCBpZiBhbiBlbGVtZW50IG92ZXJsYXBzIG90aGVyc1xuICBwcml2YXRlIGhpdFRlc3QodGVzdEVsOiBIVE1MRWxlbWVudCk6IGJvb2xlYW4ge1xuICAgIC8vIENoZWNrIGVsZW1lbnRzIGZvciBvdmVybGFwIG9uZSBieSBvbmUsIHN0b3AgYW5kIHJldHVybiBmYWxzZSBhcyBzb29uIGFzIGFuIG92ZXJsYXAgaXMgZm91bmRcbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy5hbHJlYWR5UGxhY2VkV29yZHMpIHtcbiAgICAgIGlmICh0aGlzLm92ZXJsYXBwaW5nKHRlc3RFbCwgaXRlbSkpIHsgcmV0dXJuIHRydWU7IH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLy8gUGFpcndpc2Ugb3ZlcmxhcCBkZXRlY3Rpb25cbiAgcHJpdmF0ZSBvdmVybGFwcGluZyhlMTogSFRNTEVsZW1lbnQsIGUyOiBIVE1MRWxlbWVudCkge1xuICAgIGNvbnN0IHJlY3QxID0gZTEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgY29uc3QgcmVjdDIgPSBlMi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgIGNvbnN0IG92ZXJsYXAgPSAhKFxuICAgICAgcmVjdDEucmlnaHQgPCByZWN0Mi5sZWZ0IHx8XG4gICAgICByZWN0MS5sZWZ0ID4gcmVjdDIucmlnaHQgfHxcbiAgICAgIHJlY3QxLmJvdHRvbSA8IHJlY3QyLnRvcCB8fFxuICAgICAgcmVjdDEudG9wID4gcmVjdDIuYm90dG9tXG4gICAgKTtcbiAgICByZXR1cm4gb3ZlcmxhcDtcbiAgfVxuXG4gIC8vIEZ1bmN0aW9uIHRvIGRyYXcgYSB3b3JkLCBieSBtb3ZpbmcgaXQgaW4gc3BpcmFsIHVudGlsIGl0IGZpbmRzIGEgc3VpdGFibGUgZW1wdHkgcGxhY2UuIFRoaXMgd2lsbCBiZSBpdGVyYXRlZCBvbiBlYWNoIHdvcmQuXG4gIHByaXZhdGUgZHJhd1dvcmQoaW5kZXg6IG51bWJlciwgd29yZDogQ2xvdWREYXRhKSB7XG4gICAgLy8gRGVmaW5lIHRoZSBJRCBhdHRyaWJ1dGUgb2YgdGhlIHNwYW4gdGhhdCB3aWxsIHdyYXAgdGhlIHdvcmRcbiAgICBsZXQgYW5nbGUgPSB0aGlzLm9wdGlvbnMucmFuZG9taXplQW5nbGUgPyA2LjI4ICogTWF0aC5yYW5kb20oKSA6IDA7XG4gICAgbGV0IHJhZGl1cyA9IDA7XG4gICAgbGV0IHdlaWdodCA9IDU7XG4gICAgbGV0IHdvcmRTcGFuOiBIVE1MRWxlbWVudDtcblxuICAgIC8vIENoZWNrIGlmIG1pbih3ZWlnaHQpID4gbWF4KHdlaWdodCkgb3RoZXJ3aXNlIHVzZSBkZWZhdWx0XG4gICAgaWYgKHRoaXMuZGF0YUFyclswXS53ZWlnaHQgPiB0aGlzLmRhdGFBcnJbdGhpcy5kYXRhQXJyLmxlbmd0aCAtIDFdLndlaWdodCkge1xuICAgICAgLy8gY2hlY2sgaWYgc3RyaWN0IG1vZGUgaXMgYWN0aXZlXG4gICAgICBpZiAoIXRoaXMub3B0aW9ucy5zdHJpY3QpIHsgLy8gTGluZWFybHkgbWFwIHRoZSBvcmlnaW5hbCB3ZWlnaHQgdG8gYSBkaXNjcmV0ZSBzY2FsZSBmcm9tIDEgdG8gMTBcbiAgICAgICAgd2VpZ2h0ID0gTWF0aC5yb3VuZCgod29yZC53ZWlnaHQgLSB0aGlzLmRhdGFBcnJbdGhpcy5kYXRhQXJyLmxlbmd0aCAtIDFdLndlaWdodCkgL1xuICAgICAgICAgICAgICAgICAgKHRoaXMuZGF0YUFyclswXS53ZWlnaHQgLSB0aGlzLmRhdGFBcnJbdGhpcy5kYXRhQXJyLmxlbmd0aCAtIDFdLndlaWdodCkgKiA5LjApICsgMTtcbiAgICAgIH0gZWxzZSB7IC8vIHVzZSBnaXZlbiB2YWx1ZSBmb3Igd2VpZ3RoIGRpcmVjdGx5XG4gICAgICAgIC8vIGZhbGxiYWNrIHRvIDEwXG4gICAgICAgIGlmICh3b3JkLndlaWdodCA+IDEwKSB7XG4gICAgICAgICAgd2VpZ2h0ID0gMTA7XG4gICAgICAgICAgdGhpcy5sb2dNZXNzYWdlKFxuICAgICAgICAgICAgJ3dhcm4nLFxuICAgICAgICAgICAgYFtUYWdDbG91ZCBzdHJpY3RdIFdlaWdodCBwcm9wZXJ0eSAke3dvcmQud2VpZ2h0fSA+IDEwLiBGYWxsYmFjayB0byAxMCBhcyB5b3UgYXJlIHVzaW5nIHN0cmljdCBtb2RlYCxcbiAgICAgICAgICAgIHdvcmRcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2UgaWYgKHdvcmQud2VpZ2h0IDwgMSkgeyAvLyBmYWxsYmFjayB0byAxXG4gICAgICAgICAgd2VpZ2h0ID0gMTtcbiAgICAgICAgICB0aGlzLmxvZ01lc3NhZ2UoXG4gICAgICAgICAgICAnd2FybicsXG4gICAgICAgICAgICBgW1RhZ0Nsb3VkIHN0cmljdF0gR2l2ZW4gd2VpZ2h0IHByb3BlcnR5ICR7d29yZC53ZWlnaHR9IDwgMS4gRmFsbGJhY2sgdG8gMSBhcyB5b3UgYXJlIHVzaW5nIHN0cmljdCBtb2RlYCxcbiAgICAgICAgICAgIHdvcmRcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2UgaWYgKHdvcmQud2VpZ2h0ICUgMSAhPT0gMCkgeyAvLyByb3VuZCBpZiBnaXZlbiB2YWx1ZSBpcyBub3QgYW4gaW50ZWdlclxuICAgICAgICAgIHdlaWdodCA9IE1hdGgucm91bmQod29yZC53ZWlnaHQpO1xuICAgICAgICAgIHRoaXMubG9nTWVzc2FnZShcbiAgICAgICAgICAgICd3YXJuJyxcbiAgICAgICAgICAgIGBbVGFnQ2xvdWQgc3RyaWN0XSBHaXZlbiB3ZWlnaHQgcHJvcGVydHkgJHt3b3JkLndlaWdodH0gaXMgbm90IGFuIGludGVnZXIuIFJvdW5kZWQgdmFsdWUgdG8gJHt3ZWlnaHR9YCxcbiAgICAgICAgICAgIHdvcmRcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHdlaWdodCA9IHdvcmQud2VpZ2h0O1xuICAgICAgICB9XG5cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgYSBuZXcgc3BhbiBhbmQgaW5zZXJ0IG5vZGUuXG4gICAgd29yZFNwYW4gPSB0aGlzLnIyLmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICB3b3JkU3Bhbi5jbGFzc05hbWUgPSAndycgKyB3ZWlnaHQ7XG5cbiAgICBjb25zdCB0aGF0Q2xpY2tlZCA9IHRoaXMuY2xpY2tlZDtcbiAgICB3b3JkU3Bhbi5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgdGhhdENsaWNrZWQuZW1pdCh3b3JkKTtcbiAgICB9O1xuXG4gICAgbGV0IG5vZGUgPSB0aGlzLnIyLmNyZWF0ZVRleHQod29yZC50ZXh0KTtcblxuICAgIC8vIHNldCBjb2xvclxuICAgIGlmICh3b3JkLmNvbG9yKSB7XG4gICAgICB0aGlzLnIyLnNldFN0eWxlKHdvcmRTcGFuLCAnY29sb3InLCB3b3JkLmNvbG9yKTtcbiAgICB9XG5cbiAgICBsZXQgdHJhbnNmb3JtU3RyaW5nID0gJyc7XG5cbiAgICAvLyBzZXQgY29sb3JcbiAgICBpZiAod29yZC5yb3RhdGUpIHtcbiAgICAgIHRyYW5zZm9ybVN0cmluZyA9IGByb3RhdGUoJHt3b3JkLnJvdGF0ZX1kZWcpYDtcbiAgICAgIHRoaXMucjIuc2V0U3R5bGUod29yZFNwYW4sICd0cmFuc2Zvcm0nLCB0cmFuc2Zvcm1TdHJpbmcpO1xuICAgIH1cblxuICAgIC8vIEFwcGVuZCBocmVmIGlmIHRoZXJlJ3MgYSBsaW5rIGFsb25nd2l0aCB0aGUgdGFnXG4gICAgaWYgKHdvcmQubGluaykge1xuICAgICAgY29uc3Qgd29yZExpbmsgPSB0aGlzLnIyLmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgIHdvcmRMaW5rLmhyZWYgPSB3b3JkLmxpbms7XG5cbiAgICAgIGlmICh3b3JkLmV4dGVybmFsICE9PSB1bmRlZmluZWQgJiYgd29yZC5leHRlcm5hbCkge1xuICAgICAgICB3b3JkTGluay50YXJnZXQgPSAnX2JsYW5rJztcbiAgICAgIH1cblxuICAgICAgd29yZExpbmsuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgICBub2RlID0gd29yZExpbms7XG4gICAgfVxuXG4gICAgLy8gc2V0IHpvb21PcHRpb25cbiAgICBpZiAodGhpcy5vcHRpb25zLnpvb21PbkhvdmVyICYmIHRoaXMub3B0aW9ucy56b29tT25Ib3Zlci5zY2FsZSAhPT0gMSkge1xuICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuem9vbU9uSG92ZXIudHJhbnNpdGlvblRpbWUpIHsgdGhpcy5vcHRpb25zLnpvb21PbkhvdmVyLnRyYW5zaXRpb25UaW1lID0gMDsgfVxuICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuem9vbU9uSG92ZXIuc2NhbGUpIHsgdGhpcy5vcHRpb25zLnpvb21PbkhvdmVyLnNjYWxlID0gMTsgfVxuXG4gICAgICB3b3JkU3Bhbi5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5yMi5zZXRTdHlsZSh3b3JkU3BhbiwgJ3RyYW5zaXRpb24nLCBgdHJhbnNmb3JtICR7dGhpcy5vcHRpb25zLnpvb21PbkhvdmVyLnRyYW5zaXRpb25UaW1lfXNgKTtcbiAgICAgICAgdGhpcy5yMi5zZXRTdHlsZSh3b3JkU3BhbiwgJ3RyYW5zZm9ybScsIGBzY2FsZSgke3RoaXMub3B0aW9ucy56b29tT25Ib3Zlci5zY2FsZX0pICR7dHJhbnNmb3JtU3RyaW5nfWApO1xuICAgICAgICB0aGlzLnIyLnNldFN0eWxlKHdvcmRTcGFuLCAndHJhbnNpdGlvbi1kZWxheScsIGAke3RoaXMub3B0aW9ucy56b29tT25Ib3Zlci5kZWxheX1zYCk7XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuem9vbU9uSG92ZXIuY29sb3IpIHtcbiAgICAgICAgICB3b3JkLmxpbmtcbiAgICAgICAgICAgID8gdGhpcy5yMi5zZXRTdHlsZShub2RlLCAnY29sb3InLCB0aGlzLm9wdGlvbnMuem9vbU9uSG92ZXIuY29sb3IpXG4gICAgICAgICAgICA6IHRoaXMucjIuc2V0U3R5bGUod29yZFNwYW4sICdjb2xvcicsIHRoaXMub3B0aW9ucy56b29tT25Ib3Zlci5jb2xvcik7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHdvcmRTcGFuLm9ubW91c2VvdXQgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMucjIuc2V0U3R5bGUod29yZFNwYW4sICd0cmFuc2Zvcm0nLCBgbm9uZSAke3RyYW5zZm9ybVN0cmluZ31gKTtcbiAgICAgICAgd29yZC5saW5rXG4gICAgICAgICAgPyB0aGlzLnIyLnJlbW92ZVN0eWxlKG5vZGUsICdjb2xvcicpXG4gICAgICAgICAgOiB0aGlzLnIyLnJlbW92ZVN0eWxlKHdvcmRTcGFuLCAnY29sb3InKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgd29yZFNwYW4uYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgdGhpcy5yMi5hcHBlbmRDaGlsZCh0aGlzLmVsLm5hdGl2ZUVsZW1lbnQsIHdvcmRTcGFuKTtcblxuICAgIGNvbnN0IHdpZHRoID0gd29yZFNwYW4ub2Zmc2V0V2lkdGg7XG4gICAgY29uc3QgaGVpZ2h0ID0gd29yZFNwYW4ub2Zmc2V0SGVpZ2h0O1xuICAgIGxldCBsZWZ0ID0gdGhpcy5vcHRpb25zLmNlbnRlci54IC0gKHdpZHRoIC8gMik7XG4gICAgbGV0IHRvcCA9IHRoaXMub3B0aW9ucy5jZW50ZXIueSAtIChoZWlnaHQgLyAyKTtcblxuICAgIC8vIFNhdmUgYSByZWZlcmVuY2UgdG8gdGhlIHN0eWxlIHByb3BlcnR5LCBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlXG4gICAgY29uc3Qgd29yZFN0eWxlID0gd29yZFNwYW4uc3R5bGU7XG4gICAgd29yZFN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcblxuICAgIC8vIHBsYWNlIHRoZSBmaXJzdCB3b3JkXG4gICAgd29yZFN0eWxlLmxlZnQgPSBsZWZ0ICsgJ3B4JztcbiAgICB3b3JkU3R5bGUudG9wID0gdG9wICsgJ3B4JztcblxuICAgIC8vIGFkZCB0b29sdGlwIGlmIHByb3ZpZGVkXG4gICAgaWYgKHdvcmQudG9vbHRpcCkge1xuICAgICAgdGhpcy5yMi5hZGRDbGFzcyh3b3JkU3BhbiwgJ3Rvb2x0aXAnKTtcbiAgICAgIGNvbnN0IHRvb2x0aXBTcGFuID0gdGhpcy5yMi5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICB0b29sdGlwU3Bhbi5jbGFzc05hbWUgPSAndG9vbHRpcHRleHQnO1xuICAgICAgY29uc3QgdGV4dCA9IHRoaXMucjIuY3JlYXRlVGV4dCh3b3JkLnRvb2x0aXApO1xuICAgICAgdG9vbHRpcFNwYW4uYXBwZW5kQ2hpbGQodGV4dCk7XG4gICAgICB3b3JkU3Bhbi5hcHBlbmRDaGlsZCh0b29sdGlwU3Bhbik7XG4gICAgfVxuXG4gICAgLy8gc2V0IGEgdW5pcXVlIGlkXG4gICAgd29yZFNwYW4uaWQgPSBgYW5ndWxhci10YWctY2xvdWQtaXRlbS0ke2luZGV4fWA7XG5cbiAgICB3aGlsZSAodGhpcy5oaXRUZXN0KHdvcmRTcGFuKSkge1xuICAgICAgcmFkaXVzICs9IHRoaXMub3B0aW9ucy5zdGVwO1xuICAgICAgYW5nbGUgKz0gKGluZGV4ICUgMiA9PT0gMCA/IDEgOiAtMSkgKiB0aGlzLm9wdGlvbnMuc3RlcDtcblxuICAgICAgbGVmdCA9IHRoaXMub3B0aW9ucy5jZW50ZXIueCAtICh3aWR0aCAvIDIuMCkgKyAocmFkaXVzICogTWF0aC5jb3MoYW5nbGUpKSAqIHRoaXMub3B0aW9ucy5hc3BlY3RSYXRpbztcbiAgICAgIHRvcCA9IHRoaXMub3B0aW9ucy5jZW50ZXIueSArIHJhZGl1cyAqIE1hdGguc2luKGFuZ2xlKSAtIChoZWlnaHQgLyAyLjApO1xuXG4gICAgICB3b3JkU3R5bGUubGVmdCA9IGxlZnQgKyAncHgnO1xuICAgICAgd29yZFN0eWxlLnRvcCA9IHRvcCArICdweCc7XG4gICAgfVxuXG4gICAgLy8gZG8gbm90IHBsYWNlIHRoZSBmaXJzdCB3b3JkIGFsd2F5cyByaWdodCBpbiB0aGUgbWlkZGxlXG4gICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICB3b3JkU3R5bGUubGVmdCA9IGxlZnQgKyAoKE1hdGgucmFuZG9tKCkgLSAwLjUpICogMikgKiAodGhpcy5vcHRpb25zLndpZHRoIC8gNSkgKyAncHgnO1xuICAgICAgd29yZFN0eWxlLnRvcCA9IHRvcCArICgoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiAyKSAqICh0aGlzLm9wdGlvbnMuaGVpZ2h0IC8gNSkgKyAnMzBweCc7XG4gICAgfVxuXG4gICAgLy8gRG9uJ3QgcmVuZGVyIHdvcmQgaWYgcGFydCBvZiBpdCB3b3VsZCBiZSBvdXRzaWRlIHRoZSBjb250YWluZXJcbiAgICBpZiAoXG4gICAgICAhdGhpcy5vcHRpb25zLm92ZXJmbG93ICYmXG4gICAgICAobGVmdCA8IDAgfHwgdG9wIDwgMCB8fCAobGVmdCArIHdpZHRoKSA+IHRoaXMub3B0aW9ucy53aWR0aCB8fFxuICAgICAgKHRvcCArIGhlaWdodCkgPiB0aGlzLm9wdGlvbnMuaGVpZ2h0KVxuICAgICkge1xuICAgICAgdGhpcy5sb2dNZXNzYWdlKFxuICAgICAgICAnd2FybicsXG4gICAgICAgICdXb3JkIGRpZCBub3QgZml0IGludG8gdGhlIGNsb3VkIGFuZCBvdmVyZmxvdyBpcyBzZXQgdG8gXFwnZmFsc2VcXCcuIFRoZSBlbGVtZW50IHdpbGwgYmUgcmVtb3ZlZCcsXG4gICAgICAgIHdvcmRTcGFuXG4gICAgICApO1xuICAgICAgd29yZFNwYW4ucmVtb3ZlKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5sb2dNZXNzYWdlKFxuICAgICAgJ2RlYnVnJyxcbiAgICAgICdBZGRzIG5ldyB3b3JkIDxzcGFuPicsXG4gICAgICB3b3JkU3BhblxuICAgICk7XG4gICAgdGhpcy5hbHJlYWR5UGxhY2VkV29yZHMucHVzaCh3b3JkU3Bhbik7XG5cbiAgICB0aGlzLmxvZ01lc3NhZ2UoXG4gICAgICAnZGVidWcnLFxuICAgICAgJ1BsYWNlZCB3b3JkcycsXG4gICAgICB0aGlzLmFscmVhZHlQbGFjZWRXb3Jkc1xuICAgICk7XG4gIH1cblxuICBwcml2YXRlIGxvZ01lc3NhZ2UobGV2ZWw6ICd3YXJuJyB8ICdkZWJ1ZycgfCBmYWxzZSwgLi4uYXJnczogYW55KSB7XG4gICAgaWYgKCF0aGlzLmNvbmZpZykgeyByZXR1cm47IH1cbiAgICBpZiAodGhpcy5jb25maWcubG9nID09PSAnZGVidWcnKSB7XG4gICAgICBjb25zb2xlLmxvZyhgW0FuZ3VsYXJUYWdDbG91ZE1vZHVsZSAke2xldmVsfV1gLCAuLi5hcmdzKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuY29uZmlnLmxvZyA9PT0gJ3dhcm4nICYmIGxldmVsID09PSAnd2FybicpIHtcbiAgICAgIGNvbnNvbGUud2FybihgW0FuZ3VsYXJUYWdDbG91ZE1vZHVsZSAke2xldmVsfV1gLCAuLi5hcmdzKTtcbiAgICB9XG4gIH1cblxufVxuIl19