!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core")):"function"==typeof define&&define.amd?define("angular-tag-cloud-module",["exports","@angular/core"],e):e((t=t||self)["angular-tag-cloud-module"]={},t.ng.core)}(this,function(t,e){"use strict";var o=function(){return(o=Object.assign||function(t){for(var e,o=1,i=arguments.length;o<i;o++)for(var n in e=arguments[o])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function i(t,e){var o="function"==typeof Symbol&&t[Symbol.iterator];if(!o)return t;var i,n,r=o.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(a){n={error:a}}finally{try{i&&!i.done&&(o=r["return"])&&o.call(r)}finally{if(n)throw n.error}}return s}function n(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t}var r=function(){function t(t,o){this.el=t,this.r2=o,this.clicked=new e.EventEmitter,this.dataChanges=new e.EventEmitter,this.afterInit=new e.EventEmitter,this.afterChecked=new e.EventEmitter,this.alreadyPlacedWords=[]}return t.prototype.onResize=function(t){var e=this;this.logMessage("debug","rezisze triggered"),window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(function(){e.options.realignOnResize&&e.reDraw()},200)},t.prototype.ngOnChanges=function(t){this.logMessage("debug","ngOnChanges fired",t),this.config=o({width:500,height:300,overflow:!0,strict:!1,zoomOnHover:{transitionTime:0,scale:1,delay:0,color:null},realignOnResize:!1,randomizeAngle:!1,background:null,font:null,step:2,log:!1},this.config),this.width&&(this.config.width=this.width),this.height&&(this.config.height=this.height),"boolean"==typeof this.overflow&&(this.config.overflow=this.overflow),"boolean"==typeof this.strict&&(this.config.strict=this.strict),"boolean"==typeof this.realignOnResize&&(this.config.realignOnResize=this.realignOnResize),"boolean"==typeof this.randomizeAngle&&(this.config.randomizeAngle=this.randomizeAngle),"string"==typeof this.background&&(this.config.background=this.background),"string"==typeof this.font&&(this.config.font=this.font),this.zoomOnHover&&(this.config.zoomOnHover=this.zoomOnHover),this.step&&(this.config.step=this.step),this.log&&(this.config.log=this.log),this.logMessage("warn","cloud configuration",this.config),this.config.font&&this.r2.setStyle(this.el.nativeElement,"font",this.config.font),this.config.background&&this.r2.setStyle(this.el.nativeElement,"background",this.config.background),this.reDraw(t)},t.prototype.reDraw=function(t){if(this.dataChanges.emit(t),this.afterChecked.emit(),this.logMessage("debug","dataChanges emitted"),this.alreadyPlacedWords=[],this.data){this.el.nativeElement.innerHTML="",t&&t.data&&(this.dataArr=t.data.currentValue);var e=this.config.width;this.el.nativeElement.parentNode.offsetWidth>0&&e<=1&&e>0&&(e=this.el.nativeElement.parentNode.offsetWidth*e);var i=this.config.height;this.options=o({},this.config,{aspectRatio:e/i,width:e,center:{x:e/2,y:i/2}}),this.r2.setStyle(this.el.nativeElement,"width",this.options.width+"px"),this.r2.setStyle(this.el.nativeElement,"height",this.options.height+"px"),this.drawWordCloud(),this.logMessage("debug","reDraw finished")}else console.error("angular-tag-cloud: No data passed. Please pass an Array of CloudData")},t.prototype.ngAfterContentInit=function(){this.afterInit.emit(),this.logMessage("debug","afterInit emitted")},t.prototype.ngAfterContentChecked=function(){this.afterChecked.emit(),this.logMessage("debug","afterChecked emitted")},t.prototype.descriptiveEntry=function(t){var e=t.text;return t.color&&(e+="-"+t.color),t.external&&(e+="-"+t.external),t.link&&(e+="-"+t.link),t.rotate&&(e+="-"+t.rotate),e},t.prototype.drawWordCloud=function(){var t=this;this.dataArr.sort(function(e,o){return t.descriptiveEntry(e).localeCompare(t.descriptiveEntry(o))}),this.dataArr.sort(function(t,e){return e.weight-t.weight}),this.dataArr.forEach(function(e,o){t.drawWord(o,e)})},t.prototype.hitTest=function(t){var e,o;try{for(var i=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],o=0;return e?e.call(t):{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}}}(this.alreadyPlacedWords),n=i.next();!n.done;n=i.next()){var r=n.value;if(this.overlapping(t,r))return!0}}catch(s){e={error:s}}finally{try{n&&!n.done&&(o=i["return"])&&o.call(i)}finally{if(e)throw e.error}}return!1},t.prototype.overlapping=function(t,e){var o=t.getBoundingClientRect(),i=e.getBoundingClientRect();return!(o.right<i.left||o.left>i.right||o.bottom<i.top||o.top>i.bottom)},t.prototype.drawWord=function(t,e){var o,i=this,n=this.options.randomizeAngle?6.28*Math.random():0,r=0,s=5;this.dataArr[0].weight>this.dataArr[this.dataArr.length-1].weight&&(this.options.strict?e.weight>10?(s=10,this.logMessage("warn","[TagCloud strict] Weight property "+e.weight+" > 10. Fallback to 10 as you are using strict mode",e)):e.weight<1?(s=1,this.logMessage("warn","[TagCloud strict] Given weight property "+e.weight+" < 1. Fallback to 1 as you are using strict mode",e)):e.weight%1!=0?(s=Math.round(e.weight),this.logMessage("warn","[TagCloud strict] Given weight property "+e.weight+" is not an integer. Rounded value to "+s,e)):s=e.weight:s=Math.round((e.weight-this.dataArr[this.dataArr.length-1].weight)/(this.dataArr[0].weight-this.dataArr[this.dataArr.length-1].weight)*9)+1),(o=this.r2.createElement("span")).className="w"+s;var a=this.clicked;o.onclick=function(){a.emit(e)};var l=this.r2.createText(e.text);e.color&&this.r2.setStyle(o,"color",e.color);var h="";if(e.rotate&&(h="rotate("+e.rotate+"deg)",this.r2.setStyle(o,"transform",h)),e.link){var p=this.r2.createElement("a");p.href=e.link,e.external!==undefined&&e.external&&(p.target="_blank"),p.appendChild(l),l=p}this.options.zoomOnHover&&1!==this.options.zoomOnHover.scale&&(this.options.zoomOnHover.transitionTime||(this.options.zoomOnHover.transitionTime=0),this.options.zoomOnHover.scale||(this.options.zoomOnHover.scale=1),o.onmouseover=function(){i.r2.setStyle(o,"transition","transform "+i.options.zoomOnHover.transitionTime+"s"),i.r2.setStyle(o,"transform","scale("+i.options.zoomOnHover.scale+") "+h),i.r2.setStyle(o,"transition-delay",i.options.zoomOnHover.delay+"s"),i.options.zoomOnHover.color&&(e.link?i.r2.setStyle(l,"color",i.options.zoomOnHover.color):i.r2.setStyle(o,"color",i.options.zoomOnHover.color))},o.onmouseout=function(){i.r2.setStyle(o,"transform","none "+h),e.link?i.r2.removeStyle(l,"color"):i.r2.removeStyle(o,"color")}),o.appendChild(l),this.r2.appendChild(this.el.nativeElement,o);var d=o.offsetWidth,c=o.offsetHeight,g=this.options.center.x-d/2,f=this.options.center.y-c/2,u=o.style;if(u.position="absolute",u.left=g+"px",u.top=f+"px",e.tooltip){this.r2.addClass(o,"tooltip");var y=this.r2.createElement("span");y.className="tooltiptext";var m=this.r2.createText(e.tooltip);y.appendChild(m),o.appendChild(y)}for(o.id="angular-tag-cloud-item-"+t;this.hitTest(o);)r+=this.options.step,n+=(t%2==0?1:-1)*this.options.step,g=this.options.center.x-d/2+r*Math.cos(n)*this.options.aspectRatio,f=this.options.center.y+r*Math.sin(n)-c/2,u.left=g+"px",u.top=f+"px";if(0===t&&(u.left=g+2*(Math.random()-.5)*(this.options.width/5)+"px",u.top=f+2*(Math.random()-.5)*(this.options.height/5)+"30px"),!this.options.overflow&&(g<0||f<0||g+d>this.options.width||f+c>this.options.height))return this.logMessage("warn","Word did not fit into the cloud and overflow is set to 'false'. The element will be removed",o),void o.remove();this.logMessage("debug","Adds new word <span>",o),this.alreadyPlacedWords.push(o),this.logMessage("debug","Placed words",this.alreadyPlacedWords)},t.prototype.logMessage=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];this.config&&("debug"===this.config.log?console.log.apply(console,n(["[AngularTagCloudModule "+t+"]"],e)):"warn"===this.config.log&&"warn"===t&&console.warn.apply(console,n(["[AngularTagCloudModule "+t+"]"],e)))},t.decorators=[{type:e.Component,args:[{selector:"angular-tag-cloud, ng-tag-cloud, ngtc",template:"",styles:[':host{font-family:Helvetica,Arial,sans-serif;font-size:10px;line-height:normal;color:#09f;overflow:hidden;position:relative;display:block}span{padding:0}span.w10{font-size:550%}span.w9{font-size:500%}span.w8{font-size:450%}span.w7{font-size:400%}span.w6{font-size:350%}span.w5{font-size:300%}span.w4{font-size:250%}span.w3{font-size:200%}span.w2{font-size:150%}a:hover,span.w10,span.w8,span.w9{color:#0cf}span.w7{color:#39d}span.w6{color:#90c5f0}span.w5{color:#90a0dd}span.w4{color:#90c5f0}span.w3{color:#a0ddff}span.w2{color:#9ce}span.w1{font-size:100%;color:#aab5f0}.tooltip .tooltiptext{visibility:hidden;width:inherit;background-color:#555;color:#fff;text-align:center;border-radius:6px;padding:5px 10px;position:absolute;bottom:100%;left:0;opacity:0;transition:opacity .3s}.tooltip .tooltiptext::after{content:"";position:absolute;top:100%;left:50%;margin-left:-5px;border-width:5px;border-style:solid;border-color:#555 transparent transparent}.tooltip:hover .tooltiptext{visibility:visible;opacity:1}']}]}],t.ctorParameters=function(){return[{type:e.ElementRef},{type:e.Renderer2}]},t.propDecorators={data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],step:[{type:e.Input}],overflow:[{type:e.Input}],strict:[{type:e.Input}],zoomOnHover:[{type:e.Input}],realignOnResize:[{type:e.Input}],randomizeAngle:[{type:e.Input}],background:[{type:e.Input}],font:[{type:e.Input}],config:[{type:e.Input}],log:[{type:e.Input}],clicked:[{type:e.Output}],dataChanges:[{type:e.Output}],afterInit:[{type:e.Output}],afterChecked:[{type:e.Output}],onResize:[{type:e.HostListener,args:["window:resize",["$event"]]}]},t}(),s=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[r],exports:[r],entryComponents:[r]}]}],t}();t.TagCloudComponent=r,t.TagCloudModule=s,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=angular-tag-cloud-module.umd.min.js.map